{
  "@class" : "flow",
  "name" : "flow1",
  "nodes" : [ {
    "@class" : "start",
    "name" : "start",
    "outlets" : [ { "name" : "start_sftp", "dataName" : "sftpcfg" } ],
    "duration" : 300
  }, {
    "@class" : "end",
    "name" : "end",
    "outlets" : [ { "name" : "mergecsv_end", "dataName" : "mergecsv" } ]
  }, {
    "@class" : "action",
    "name" : "sftp",
    "inlets" : [ { "name" : "start_sftp", "dataName" : "sftpcfg" } ],
    "outlets" : [ { "name" : "sftp_data1trans", "dataName" : "data1" }, { "name" : "sftp_mergecsv", "dataName" : "data2" } ],
    "cmd.class" : "etl.cmd.SftpCmd",
    "exe.type" : "mr",
    "input.format" : "Line",
    "sftp.clean" : "false",
    "sftp.host" : "127.0.0.1",
    "sftp.port" : "22",
    "sftp.user" : "player",
    "sftp.pass" : "123456"
  }, {
    "@class" : "action",
    "name" : "data1trans",
    "inlets" : [ { "name" : "sftp_data1trans", "dataName" : "data1" } ],
    "outlets" : [ { "name" : "data1trans_mergecsv", "dataName" : "data1csv" } ],
    "cmd.class" : "etl.cmd.CsvTransformCmd",
    "exe.type" : "mr",
    "input.format" : "File",
    "skip.header" : "true",
    "input.endwithcomma" : "true",
    "col.op" : "i|8:var groupFunClass = Java.type(\"etl.util.GroupFun\"); groupFunClass.getParentFolderName(pathname)",
    "output.type" : "single"
  }, {
    "@class" : "action",
    "name" : "mergecsv",
    "inlets" : [ { "name" : "data1trans_mergecsv", "dataName" : "data1csv" }, { "name" : "data1trans_mergecsv", "dataName" : "data2" } ],
    "outlets" : [ { "name" : "mergecsv_end", "dataName" : "mergecsv" } ],
    "cmd.class" : "etl.cmd.CsvMergeCmd",
    "exe.type" : "mr",
    "input.format" : "File",
    "src.entity" : "'/flow1/data1csv/'+WFID+'/*','/flow1/data2/'+WFID+'/*'",
    "src.keys" : "1,0",
    "src.skipHeader" : "false, true",
    "join.type" : "inner",
    "ret.value" : "csv0.concat('\\,').concat(table1[1]).concat('\\,').concat(table1[2]).concat('\\,').concat(table1[3]).concat('\\,').concat(table1[4])"
  }],
  "links" : [ {
    "fromNodeName" : "start",
    "toNodeName" : "sftp",
    "linkType" : "success"
  }, {
    "fromNodeName" : "sftp",
    "toNodeName" : "data1trans",
    "linkType" : "success"
  }, {
    "fromNodeName" : "sftp",
    "toNodeName" : "mergecsv",
    "linkType" : "success"
  }, {
    "fromNodeName" : "data1trans",
    "toNodeName" : "mergecsv",
    "linkType" : "success"
  }, {
    "fromNodeName" : "mergecsv",
    "toNodeName" : "end",
    "linkType" : "success"
  } ],
  "data" : [ {
    "name" : "sftpcfg",
    "location" : "/flow1/sftpcfg/test1.sftp.map.properties",
    "instance" : "false"
  },{
    "name" : "data1",
    "location" : "/flow1/data1/"
  }, {
    "name" : "data2",
    "location" : "/flow1/data2/"
  }, {
    "name" : "data1csv",
    "location" : "/flow1/data1csv/"
  }, {
    "name" : "mergecsv",
    "location" : "/flow1/merge/"
  }],
  "defaultFs" : "hdfs://127.0.0.1:19000/",
  "wfName" : "flow1"
}
